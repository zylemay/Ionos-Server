---
import { Image } from "astro:assets";
import { Icon } from "astro-icon/components";
import { getLangFromUrl, getUrlWithoutLang, useTranslations, useTranslatedPath } from "@i18n/utils";

const isDev = import.meta.env.DEV;

const lang = getLangFromUrl(Astro.url);
const path = getUrlWithoutLang(Astro.url);
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);

let pages = [
	{
		title: "Home",
		url: "/",
	},
	// {
	// 	title: "Services",
	// 	url: "/services",
	// },
	{
		title: "Blog",
		url: "/blog/",
	},
	{
		title: t("contacts"),
		url: "/contact/",
	},
];

// if (isDev) {
// 	pages.push({
// 		title: "Overview",
// 		url: "/system/overview",
// 	});
// }

const { pathname } = Astro.url;
---

<header>
	<a href={translatePath("/")} aria-label="Home" class="logo absolute z-50 flex h-[4.5rem] items-center md:h-[5.9rem]">
		<svg
			version="1.1"
			xmlns="http://www.w3.org/2000/svg"
			xmlns:xlink="http://www.w3.org/1999/xlink"
			viewBox="0 0 2809.6 545.3"
			xml:space="preserve"
			class="logo-svg h-7 w-36 md:h-9"
			fill="transparent"
			stroke="currentColor"
			stroke-width="10">
			<path
				d="M81.3,373.8v-184c0-3.4,0.3-6.7,0.9-10c3.2-18.1,17.5-69.5,77.3-78.8c0,0,43.7-5.5,76.9,27.7c0.5,0.5,0.5,1.3,0,1.8
	L202.7,164c-0.5,0.5-1.3,0.5-1.8,0c-3-3.1-14.1-12.8-35.6-12.8c-24.6,0-32.5,28.4-33.1,30.8c0,0.1-0.1,0.2-0.1,0.3v185.1
	c0,0.1,0,0.3,0.1,0.4c0.9,2.4,9.4,23.5,35,23.6h0.1c0.8,0.1,15.6,0.9,29.8-13.4l66.5-67.2c0.1-0.1,0.1-0.1,0.1-0.2
	c0.5-0.8,2.9-5.1,3.6-12.6c0-0.1,0-0.1,0-0.1v-51.6c0-2.8-0.8-5.5-2.4-7.9c-2.4-3.6-7.5-10.3-11.9-14.2c-0.5-0.5-0.6-1.3-0.1-1.8
	l35.3-35.3c0.4-0.4,1.2-0.5,1.7-0.1c5,4.1,29.5,25.9,29.5,54.6v66.2c0,2-0.2,3.9-0.7,5.9c-1.6,6.2-6.5,19.7-21.3,34.5L216,429.5
	c-2.6,2.6-5.8,4.9-9.2,6.5c-12.2,5.6-42.5,16.1-76.9,0.5h-0.1c-1-0.4-28.7-11.1-46.5-51.4C82.1,381.5,81.3,377.7,81.3,373.8z">
			</path>
			<path
				d="M404.5,171.5v184.1c0,3.4-0.3,6.7-0.9,10c-3.2,18.1-17.5,69.5-77.3,78.8c0,0-43.7,5.5-76.9-27.7c-0.5-0.5-0.5-1.3,0-1.8
	l33.5-33.5c0.5-0.5,1.3-0.5,1.8,0c3,3.1,14.1,12.8,35.6,12.8c24.6,0,32.5-28.4,33.1-30.8c0-0.1,0.1-0.2,0.1-0.3V178
	c0-0.1,0-0.3-0.1-0.4c-0.9-2.4-9.4-23.5-35-23.6h-0.1c-0.8-0.1-15.6-0.9-29.8,13.4L222,234.6c-0.1,0.1-0.1,0.1-0.1,0.2
	c-0.5,0.8-2.9,5.1-3.6,12.6c0,0.1,0,0.1,0,0.1v51.6c0,2.8,0.8,5.5,2.4,7.9c2.4,3.6,7.5,10.3,11.9,14.2c0.5,0.5,0.6,1.3,0.1,1.8
	l-35.3,35.3c-0.4,0.4-1.2,0.5-1.7,0.1c-5-4.1-29.5-25.9-29.5-54.6v-66.2c0-2,0.2-3.9,0.7-5.9c1.6-6.2,6.5-19.7,21.3-34.5l81.4-81.4
	c2.6-2.6,5.8-4.9,9.2-6.5c12.2-5.6,42.5-16.1,76.9-0.5h0.1c1,0.4,28.7,11.1,46.5,51.4C403.6,163.8,404.5,167.6,404.5,171.5z">
			</path>
			<g>
				<path
					d="M798.5,166.6c26.3,0,48.4,9.2,66.2,27.5c18.5,18.7,27.7,40.8,27.7,66.2v119.6c0,5.2-1.8,9.2-5.4,11.9
		c-3.4,3.2-7.2,4.5-11.3,4.5c-4.3,0-7.9-1.6-11.5-4.7c-3.4-3.2-5-6.8-5-11.7V260.3c0-16.9-5.9-31.1-17.6-42.8
		c-11.9-12.2-26.3-18.2-43.2-18.2c-16.9,0-31.1,6.1-43.2,18.2c-11.9,11.9-18,25.9-18,42.8v119.6c0,4.5-1.6,8.3-4.7,11.7
		c-3.2,3.4-7,4.7-11.7,4.7c-4.1,0-7.7-1.1-10.8-4.1c-3.6-3.2-5.4-7-5.4-12.4V260.3c0-16.7-5.9-30.8-17.8-42.8
		c-11.9-12.2-26.3-18.2-43-18.2c-16.9,0-31.1,6.3-43,18.2c-11.7,11.9-18,25.9-18,42.8v119.6c0,4.7-1.6,8.6-4.7,11.5
		c-3.4,3.4-7.2,4.7-11.5,4.7c-5.2,0-9.2-1.6-12.2-5c-2.9-3.4-4.5-7.2-4.5-11.5V258.7c0-25.7,9.7-47.5,27.9-65.3
		c18.5-18,40.5-27,66-27c19.6,0,37.4,5.4,53.4,16.4c4.7,3.4,9.2,7,13.5,11c4.3,4.1,7.9,8.3,10.8,12.6c3.4-4.7,7-9.2,11-13.3
		c4.1-4.1,8.3-7.4,13.1-10.6c16.2-10.8,34-16.4,53.1-16.4L798.5,166.6z">
				</path>
				<path
					d="M1164.4,379.4c0,4.7-1.6,8.6-4.7,11.7c-3.4,3.4-7.2,5-11.7,5c-5,0-9-1.6-12.4-4.5c-2.9-3.4-4.5-7.4-4.5-12.2v-17.3
		c-3.2,2.9-6.8,6.1-10.8,9.2c-4.1,3.2-7.7,5.6-10.8,7.7c-9,5.6-18.5,9.9-28.4,12.8c-9.9,2.9-20.3,4.3-31.3,4.3
		c-31.7,0-58.8-11.3-81.3-33.8C946,339.5,935,312.5,935,281.2c0-31.3,11-58.3,33.6-81.1c22.5-22.7,49.5-33.8,81.3-33.8
		c31.7,0,59.2,11,81.5,33.8c22.5,22.7,33.6,49.8,33.6,81.1v98.6L1164.4,379.4z M1107.7,338.9c16-16,23.9-35.1,23.9-57.4
		s-7.9-41.7-23.9-58.1c-15.8-15.8-35.1-23.6-57.9-23.6c-22.5,0-41.9,7.7-57.6,23.6c-16.2,16.4-23.9,36-23.9,57.9
		c0,22.1,7.7,41.2,23.9,57.6c16,16,35.1,23.9,57.6,23.9C1072.5,362.7,1091.9,354.9,1107.7,338.9z">
				</path>
				<path
					d="M1227.5,160.5c11,0,16.4,5.4,16.4,16.4v209.6c0,12.6-2.9,24.5-8.6,35.6c-5.6,11-14,20.9-25,29.9
		c-10.6,8.6-22.1,15.1-35.1,19.6c-13.1,4.5-27,6.8-41.9,6.8c-11,0-16.4-5.4-16.4-16.4c0-10.8,5.4-16.2,16.4-16.2
		c22.1,0,40.8-6.1,56.1-18.2c7-5.6,12.4-11.9,16.2-18.7c3.8-6.8,5.6-14,5.6-21.8V177.4c0-11,5.4-16.4,16.2-16.4V160.5z
		 M1227.5,112.6c-10.8,0-16.2-5.6-16.2-16.7v-4.5c0-10.8,5.4-16.2,16.2-16.2c11,0,16.4,5.4,16.4,16.2v4.5
		C1243.9,107,1238.5,112.6,1227.5,112.6z">
				</path>
				<path
					d="M1957.3,112.6c-10.8,0-16.2-5.6-16.2-16.7v-4.5c0-10.8,5.4-16.2,16.2-16.2c11,0,16.4,5.4,16.4,16.2v4.5
		C1973.7,107,1968.3,112.6,1957.3,112.6z">
				</path>
				<path
					d="M1515.9,278.3c0,0.7,0,1.4,0,2c0,0.7-0.2,1.6-0.7,2.7l0.2-0.2c-2.3,8.1-7.7,12.2-16,12.2h-178.6c1.4,8.6,4.1,16.4,7.9,23.9
		c3.8,7.4,9.5,14,16,20.5c15.8,15.1,34.2,23,56.3,23c7,0,13.5-0.9,19.6-2.5c6.1-1.6,12.2-3.8,18.2-6.8h-0.2c5.6-2.9,11-6.5,16-10.8
		c5-4.3,9.5-9.2,13.3-14.9c2.5-3.4,6.3-5.6,11.5-6.8h2.5c3.2,0,6.3,0.9,9.2,2.7c4.1,2.5,6.5,6.1,7.4,10.8c0.2,0.7,0.5,1.1,0.5,1.6
		c0,0.4,0,1.1,0,1.8c0,3.4-1.1,6.5-3.2,9.5c-5.2,7.4-11.3,14.2-18.2,20.3c-7,6.1-14.6,11.3-22.7,15.5c-16.9,8.8-34.7,13.3-53.4,13.3
		c-31.3,0-58.8-10.8-81.5-33.8c-22.7-23-33.6-50.2-33.6-81.3v-3.4c0-30.8,12.4-57.6,34.9-79.5c22.3-21.8,49.3-32.4,80.2-32.4
		c31.3,0,58.1,10.6,80.4,32.4c11,10.8,19.4,23.2,25.2,36.5c5.9,13.3,9.2,27.9,9.2,43.9v0.5L1515.9,278.3z M1480.6,262.3
		c-2-7.9-5.2-15.3-9.5-22.3c-4.3-7-9-13.5-14.9-18.9c-7.4-7-16.2-11.9-25.7-15.5c-9.5-3.6-19.4-5.4-29.7-5.4
		c-20.5,0-38.7,7.2-54.9,21.6v-0.2c-12.4,11.5-20.5,25.2-24.3,41.2h158.7L1480.6,262.3z">
				</path>
				<path
					d="M1731.4,301c3.8,7,5.6,15.8,5.6,26.6v4.5c0,1.6,0,3.2-0.2,4.5c-0.5,4.5-1.6,9-3.6,13.7c-2,4.7-4.7,9.2-8.1,13.5
		c-8.6,11-19.6,19.4-32.9,25c-13.3,5.6-29,8.3-47.3,8.3c-18.7,0-35.8-4.1-51.3-12.8c-7.7-4.3-14.6-9.5-20.9-15.5
		s-11.5-12.8-15.5-20.3h0.2c-1.8-2.7-2.7-5.6-2.7-8.6c0-0.9,0-1.8,0-2.5s0.2-1.6,0.7-2.7c0.7-2,1.6-3.8,2.7-5.4
		c1.1-1.6,2.9-2.9,5.2-4.1l-0.2,0.2c2.7-1.8,5.4-2.7,8.1-2.7c2,0,3.8,0.4,5.4,1.1v-0.2c2,0.7,3.8,1.8,5.4,3.2
		c1.6,1.4,2.9,2.9,4.1,4.7c2.9,4.7,6.3,9,10.1,13.1c3.8,4.1,8.3,7.4,13.5,10.4c5.4,2.9,11,5.2,16.7,6.8s11.7,2.3,18,2.3
		c12.2,0,22.7-1.8,31.7-5.4c9-3.6,16.2-8.6,21.4-14.9c2.9-3.8,4.5-7,5-9.5V333c0.2-1.1,0.4-2.3,0.4-3.4c0-1.1,0-2,0-2.7
		c0-2,0-3.8-0.2-5.4c-0.2-1.6-0.7-2.9-1.4-4.1c-2-3.4-5.6-7.4-11.3-11.3c-4.1-2.9-10.1-4.7-17.6-6.3c-7.4-1.6-16.2-2.3-26.6-2.3
		c-14.2,0-26.6-1.4-37.2-4.1c-10.6-2.7-19.1-6.5-25.9-11.5c-5.2-3.8-9.7-7.9-13.5-11.9c-3.8-4.1-6.8-8.1-8.8-12.2
		c-2.9-6.1-4.7-14.2-4.3-24.3l0.2-5.9c0.2-4.3,1.4-8.8,3.4-13.5c2-4.7,4.7-9.2,8.1-13.7c8.6-11,19.6-19.4,32.9-25
		c13.3-5.6,29-8.6,47.1-8.6c12.2,0,23.9,2,35.1,6.1c11.3,4.1,21.4,9.7,30.6,16.9c2,1.6,3.6,3.2,4.7,4.7c1.1,1.6,1.8,4.1,2,7.4
		c0,2.3-0.2,4.3-0.7,6.1c-0.4,1.8-1.4,3.4-2.7,5c-1.6,2-3.2,3.4-5,4.3c-1.8,0.9-4.3,1.8-7.4,1.8c-4.1,0.2-7.7-1.1-10.6-3.2
		c-0.2,0-0.4-0.2-0.7-0.5c-12.8-10.8-27.7-16.2-44.6-16.2c-12.4,0-23,1.8-31.7,5.4s-15.8,8.6-21.2,14.9v-0.2c-2.9,3.8-4.5,7-4.7,9.5
		v2.7c0,5.9,0.2,9.7,0.9,11.5v-0.5c1.8,3.4,5.6,7.2,11.5,11.3c4.3,2.7,10.1,5,17.6,6.5c7.4,1.6,16.2,2.5,26.1,2.5
		c14,0,26.3,1.4,36.9,3.8c10.6,2.5,19.4,6.1,26.3,10.8c4.7,3.4,8.8,7,12.4,10.6c3.6,3.6,6.5,7.4,8.8,11.3h-0.2V301z">
				</path>
				<path
					d="M1888.1,362.3c4.5,0,8.6,1.8,11.9,5.2c3.4,3.2,5.2,7,5.2,11.7s-1.8,8.8-5.2,12.2c-3.4,3.4-7.4,4.7-12.2,4.7
		c-32.4,0-60.1-11-83.3-33.8c-11.3-11.3-19.8-23.9-25.9-37.6c-6.1-13.7-10.1-28.8-10.1-45.3V92.5c0-4.3,1.8-8.3,5.2-12.2
		c3.4-3.2,7.4-4.7,12.2-4.7c4.7,0,8.8,1.6,12.2,4.7c3.2,3.2,4.7,7.2,4.7,12.2v70.9h66.2c4.3,0,8.3,1.8,12.2,5.2
		c3.2,3.2,4.7,7.2,4.7,11.9c0,5-1.6,9-4.7,12.4c-3.8,2.9-7.9,4.5-12.2,4.5h-66.2v79.9c0,23.4,8.6,43.5,25,59.9
		c16.7,16.4,36.7,24.8,60.1,24.8L1888.1,362.3z">
				</path>
				<path
					d="M1956.8,160.5c5,0,9.7,2.3,14,7c0.7,1.1,1.4,2.5,2,4.1c0.7,1.6,0.9,3.6,0.9,6.1v201.5c0,2.5-0.2,4.5-0.9,6.1
		c-0.7,1.6-1.4,2.9-2.3,4.1c-4.3,4.5-8.8,6.8-13.5,6.8c-4.3,0-8.1-2-11.5-5.2c-3.6-3.4-5.4-7.2-5.4-11.9V177.4
		c0-4.7,1.8-8.3,5.4-11.7c3.4-3.2,7.2-5.2,11.5-5.2H1956.8z">
				</path>
				<path
					d="M2198.4,346.5c0,0.2,0,0.2,0,0.2s0,0,0,0.2c1.1,1.6,2,3.2,2.5,5c0.5,1.8,0.7,3.8,0.7,6.3c-0.2,5.2-2.5,9-6.5,11.3l0.2-0.2
		c-20.7,17.1-44.6,25.7-71.8,25.7c-31.3,0-58.5-10.8-81.1-33.3c-22.5-22.5-33.6-49.8-33.6-81.1c0-31.7,11.3-58.8,33.6-80.8
		c22.7-22.3,49.8-33.6,81.1-33.6c13.1,0,25.7,2.3,37.8,6.5c12.2,4.3,23.2,10.4,33.3,18.2c2,1.6,3.6,3.4,4.7,5.2
		c1.1,1.8,1.8,4.3,2.3,7.4c0,2-0.5,4.1-1.1,6.1c-0.7,2-1.6,3.8-2.7,5.6c-1.4,1.6-2.9,2.9-4.5,3.8c-1.6,0.9-3.6,1.6-6.1,1.8h-2.3
		c-3.4,0-6.8-1.1-10.1-3.6c-7.4-5.6-15.5-10.1-24.3-13.3c-8.8-3.2-17.6-4.7-26.6-4.7c-22.3,0-41.4,7.9-57.4,23.9
		c-16,16-23.9,35.1-23.9,57.4c0,22.5,7.9,41.7,23.9,57.4c15.8,15.8,34.9,23.6,57.4,23.6c19.6,0,36.7-6.1,51.3-18
		c3.2-2.5,6.3-3.8,9.7-3.8h2.3c4.7,0.7,8.6,2.9,11.5,6.8H2198.4z">
				</path>
				<path
					d="M2445.7,199c22.5,22.7,34,49.5,34,81.1c0,31.7-11.5,58.5-34,81.1c-22.3,22.3-49.1,33.8-80.8,33.8
		c-31.5,0-58.5-11.3-81.1-33.8c-22.5-22.3-33.8-49.3-33.8-81.1c0-31.5,11.3-58.5,33.8-81.1s49.5-33.8,81.1-33.8
		C2396.6,165.3,2423.4,176.7,2445.7,199z M2364.8,361.4c22.7,0,41.9-7.9,57.6-23.6c15.8-15.8,23.6-34.9,23.6-57.6
		c0-22.3-7.9-41.4-23.6-57.4c-15.8-15.8-34.9-23.6-57.6-23.6c-22.7,0-41.9,7.9-57.6,23.6c-16,16.4-23.9,35.6-23.9,57.6
		c0,22.3,7.9,41.4,23.9,57.6c15.8,15.8,34.9,23.6,57.6,23.6V361.4z">
				</path>
			</g>
		</svg>
	</a>
	<div data-xdata="{ open: false }" class="navigation fixed right-0 top-0 z-50" data-xbind.class="{'w-full navbar-open': open}">
		<div class="ml-auto md:max-w-fit" data-xbind.class="{'max-w-3xl': open, 'max-w-[8rem]': !open }">
			<div class="mx-auto w-full">
				<div
					class="shadow-thick resizable nav-container squircle relative mx-auto flex w-full flex-col justify-center overflow-x-hidden bg-zinc-900 backdrop-blur-xl backdrop-filter md:flex-row-reverse">
					<div class="flex flex-row items-center justify-end md:hidden">
						<a class="px-3 py-[0.4rem] pl-4" href={translatePath("/contact/")} aria-label="Contact Page">
							<Icon class="text-white" name="octicon:mail-16" width="20" data-xbind.class="{'hidden': open}" />
						</a>
						<button
							data-xon.click="open = !open"
							data-xbind.style="{'padding-top': open ? '1rem' : '0.4rem'}"
							aria-label="Open navbar"
							class="inline-flex items-center justify-center px-3 py-[0.4rem] pr-4 text-white hover:text-blue-300 focus:text-white focus:outline-none">
							<svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
								<path
									data-xbind.class="{'hidden': open, 'inline-flex': !open }"
									class="inline-flex"
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M4 6h16M4 12h16M4 18h16">
								</path>
								<path
									data-xbind.class="{'hidden': !open, 'inline-flex': open }"
									class="hidden"
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M6 18L18 6M6 6l12 12">
								</path>
							</svg>
						</button>
					</div>
					<nav data-xbind.class="{'flex': open, 'hidden': !open}" class="hidden flex-grow flex-col justify-center py-12 md:flex md:py-0">
						<ul
							class="flex list-none flex-col items-end justify-center gap-2 px-2 text-center text-3xl md:flex-row md:items-center md:text-base">
							{
								pages.map((page) => (
									<li data-cursor-hover>
										<a
											href={translatePath(page.url)}
											class={`inline-block cursor-pointer px-1 py-[0.33rem] ${
												page.url === pathname ||
												page.url === pathname.replace(/^\/it|\/$/, "") ||
												(page.url === "/blog" && (pathname.startsWith("/blog") || pathname.startsWith("/it/blog")))
													? "active"
													: ""
											}`}>
											<span class="menu-item-container inline-block">
												<span class="menu-item px-4 py-1 font-semibold uppercase tracking-wide text-zinc-400 hover:text-white focus:text-white focus:shadow-none focus:outline-none">
													{page.title}
												</span>
											</span>
										</a>
									</li>
								))
							}
							<li>
								<a href={translatePath(path, `${lang === "it" ? "en" : "it"}`)} class="inline-block cursor-pointer px-1 py-[0.33rem]">
									<span class="menu-item-container inline-block">
										<span
											class="menu-item px-4 py-1 font-semibold uppercase tracking-wide text-zinc-400 hover:text-white focus:text-white focus:shadow-none focus:outline-none">
											{lang === "it" ? "en" : "it"}
										</span>
									</span>
								</a>
							</li>
						</ul>
					</nav>
				</div>
			</div>
		</div>
	</div>
</header>

<style>
	.navigation {
		mix-blend-mode: difference;
	}
	.navigation.navbar-open {
		mix-blend-mode: luminosity;
	}
	.navigation,
	.logo {
		padding: 1rem var(--base-padding-x);
	}
	@media (min-width: 768px) {
		.navigation,
		.logo {
			padding: 2rem var(--base-padding-x);
		}
	}
	.resizable:before {
		content: "|";
		position: absolute;
		left: 0.4rem;
		top: 0.36rem;
		font-size: 12px;
		line-height: 23px;
		color: #8e8e8e;
		opacity: 0;
		text-shadow: 4px 0 #8e8e8e;
		transition: all 0.5s ease;
	}
	.collapsed .resizable:before {
		opacity: 1;
	}
	nav a .menu-item-container {
		border-radius: 0.45rem;
	}
	nav a.active .menu-item-container,
	nav a:hover .menu-item-container {
		transition: background-color 0.3s ease;
	}
	nav ul:not(.collapsed) a.active .menu-item-container {
		transition-duration: 0.5s;
		background: #aaa;
	}
	nav ul:not(.collapsed) a:hover .menu-item-container {
		background: #fff;
	}
	nav ul:not(.collapsed) a.active .menu-item-container .menu-item,
	nav ul:not(.collapsed) a:hover .menu-item-container .menu-item {
		color: #000;
	}
	nav ul.collapsed a.active .menu-item-container .menu-item,
	nav ul.collapsed a:hover .menu-item-container .menu-item {
		color: #fff;
	}
</style>

<script>
	import { gsap } from "gsap";
	import { ScrollTrigger } from "gsap/ScrollTrigger";
	import { DrawSVGPlugin } from "gsap/DrawSVGPlugin";

	gsap.registerPlugin(DrawSVGPlugin, ScrollTrigger);

	function init() {
		gsap.timeline({
			defaults: {
				duration: 1,
				ease: "power2.out",
			},
		})
			.from(".logo-svg path", { drawSVG: 0 })
			.to(".logo-svg path", { fill: "#000", duration: 2 }, "<+=0.5");

		let isHoveringMenu = false;
		let menuCollapsed = false;

		const pageLinksUl = document.querySelector("header .nav-container nav ul");

		if (!pageLinksUl) {
			return;
		}

		let menuCollapseTl = gsap
			.timeline({
				defaults: {
					ease: "back.inOut(1.7)",
					duration: 0.4,
				},
				paused: true,
				onStart: () => {
					pageLinksUl.classList.add("collapsed");
				},
			})
			.to("header .nav-container", { width: 125 })
			.to(
				pageLinksUl,
				{
					x: () => {
						const pathName = window.location.pathname;

						if (pathName === "/" || pathName === "/it/") {
							return "9.5rem";
						} else if (pathName.startsWith("/blog") || pathName.startsWith("/it/blog")) {
							return "3.5rem";
						}

						return "-3.5rem";
					},
				},
				"<",
			);

		const isTouchDevice = window.matchMedia("(hover: none)").matches;

		if (window.innerWidth >= 768 && !isTouchDevice) {
			function expandMenu() {
				menuCollapseTl.reverse();
				pageLinksUl?.classList.remove("collapsed");
				document.querySelector("header .navigation")?.classList.remove("collapsed");
				menuCollapsed = false;
			}

			function collapseMenu() {
				if (window.scrollY > 200) {
					menuCollapseTl.play();
					pageLinksUl?.classList.add("collapsed");
					document.querySelector("header .navigation")?.classList.add("collapsed");
					menuCollapsed = true;
				}
			}

			collapseMenu();

			const navContainer = document.querySelector(".nav-container") as HTMLElement;

			function mouseEnterHandler() {
				isHoveringMenu = true;
				expandMenu();
			}

			function mouseLeaveHandler() {
				isHoveringMenu = false;
				collapseMenu();
			}

			function handleScroll() {
				if (window.scrollY > 200 && !isHoveringMenu && !menuCollapsed) {
					collapseMenu();
				} else if (window.scrollY <= 200 && menuCollapsed) {
					expandMenu();
				}
			}

			navContainer?.removeEventListener("mouseenter", mouseEnterHandler);
			navContainer?.addEventListener("mouseenter", mouseEnterHandler);

			navContainer?.removeEventListener("mouseleave", mouseLeaveHandler);
			navContainer?.addEventListener("mouseleave", mouseLeaveHandler);

			window?.removeEventListener("scroll", handleScroll);
			window?.addEventListener("scroll", handleScroll);
		}
	}

	document.removeEventListener("DOMContentLoaded", init); // astro:page-load
	document.addEventListener("DOMContentLoaded", init); // astro:page-load
</script>
